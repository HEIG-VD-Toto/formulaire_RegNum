%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LaTeX Template: Two Column Colour Article
%
% Source: http://www.howtotex.com/
% Feel free to distribute this template, but please keep the
% referal to howtotex.com.
% Date: Feb 2011
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% How to use overleaf.com: 
%
% You edit the source code here on the left, and the preview on the
% right shows you the result within a few seconds.
%
% You can upload figures, bibliographies, custom classes and
% styles using the files menu.
%
% If you're new to LaTeX, the wikibook is a great place to start:
% http://en.wikibooks.org/wiki/LaTeX
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% adaptions made by wolfgang stoettner mail@stoettner.net
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Preamble
\documentclass[	DIV=calc,%
							paper=a4,%
							fontsize=11pt,%
							twocolumn]{scrartcl} % KOMA-article class
\usepackage[french]{babel}	% English language/hyphenation
\usepackage[protrusion=true,expansion=true]{microtype}	% Better typography
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{pythontex} % Math packages
\usepackage[pdftex]{graphicx} % Enable pdflatex
\usepackage{wrapfig} % enable figure wrapping
\usepackage[svgnames]{xcolor} % Enabling colors by their 'svgnames'
\usepackage[hang, small,labelfont=bf,up,textfont=it,up]{caption} % Custom captions under/above floats
\usepackage{epstopdf} % Converts .eps to .pdf
\usepackage{subfig}	% Subfigures
\usepackage{booktabs} % Nicer tables
\usepackage{fix-cm}	% Custom fontsizes
\usepackage{booktabs} % prof. looking tables (www.en.wikibooks.org/wiki/LaTeX/Tables#Professional_tables)
\usepackage{float}
\usepackage{tgtermes}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{pdfpages}
\usepackage[smartEllipses]{markdown}
\usepackage{tikz}
\usepackage{wrapfig}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{math}
\usetikzlibrary{shapes.misc}
\usetikzlibrary{arrows.meta,decorations.markings} % arrow and decorations
\usepackage{blox}
%%% Custom sectioning (sectsty package)
\usepackage{sectsty} % Custom sectioning (see below)
\allsectionsfont{%		% Change font of al section commands
	\usefont{OT1}{phv}{b}{n}%	% bch-b-n: CharterBT-Bold font
	}

\sectionfont{%		% Change font of \section command
	\usefont{OT1}{phv}{b}{n}%	% bch-b-n: CharterBT-Bold font
	}
%%% Headers and footers
\usepackage{fancyhdr} % Needed to define custom headers/footers
	\pagestyle{fancy} % Enabling the custom headers/footers
\usepackage{lastpage}	

% Header (empty)
\lhead{}
\chead{}
\rhead{\today}
% Footer (you may change this to your own needs)
\lfoot{\footnotesize \texttt{formulaire RegNum} \textbullet \vspace{5pt} Antonin Kenzi}
\cfoot{}
\rfoot{\footnotesize page \thepage\ of \pageref{LastPage}}	% "Page 1 of 2"
\renewcommand{\headrulewidth}{0.0pt}
\renewcommand{\footrulewidth}{0.4pt}
\newcommand{\hformbar}[1]{\bigskip\hrule\vspace{5pt}} % creates a horizontal bar to separate formulae better; space adaptions can be made centrally here


%%% Creating an initial of the very first character of the content
\usepackage{lettrine}
\newcommand{\initial}[1]{%
     \lettrine[lines=3,lhang=0.3,nindent=0em]{
     				\color{DarkRed}
     				{\textsf{#1}}}{}}

%%% Title, author and date metadata
\usepackage{titling} % For custom titles

\newcommand{\HorRule}{\color{DarkRed}%	% Creating a horizontal rule
									  	\rule{\linewidth}{1pt}%
										}
\pretitle{\vspace{-30pt} \begin{flushleft} \HorRule 
				\fontsize{15}{15} \usefont{OT1}{phv}{b}{n} \color{DarkRed} \selectfont 
				}
\title{Formulaire RegNum} % Title of your article goes here
\posttitle{\par\end{flushleft}}
\preauthor{\vspace{-20pt} \begin{flushleft}\large \usefont{OT1}{phv}{b}{sl} \color{DarkRed}}
\author{Kenzi Antonin}	% Author name goes here
\postauthor{\vspace{-20pt} \footnotesize \usefont{OT1}{phv}{m}{sl} \color{Black}  \par\end{flushleft}\HorRule}
\date{\vspace{-30pt} \today} % No date
\newcounter{mycounter}
%%% wws: create a non-indented formula name
\newcommand{\formdesc}[1]{\noindent\textbf{#1} \addtocounter{mycounter}{1} \hfill \themycounter}
\newcommand{\formtitle}[1]{\noindent\underline{#1}}
%%% Begin document -----------------------------------------------------------------
\begin{document}
\maketitle
\thispagestyle{fancy} 	% Enabling the custom headers/footers for the first page 
% The first character should be within \initial{}

\formdesc{Concept}

3 objectif à la régulation : 
\begin{enumerate}
    \item Stable
    \item Rapide 
    \item Bien amorti
\end{enumerate}

Deux genres de régulation :
\begin{enumerate}
    \item Correspondance : signal y(t) suit la consigne w(t)
    \item maintien : signal y(t) devrait ne pas ou peu être influencé par les perturbations v(t)
\end{enumerate}
\hformbar

\formdesc{Différence analogique/numérique}

{\footnotesize 
\begin{center}
    \begin{tabular}{c|c}
        Analogique & Numérique \\ \hline
        Signaux temp u(t), y(t) & signaux temp u[k], y[k]\\ \hline
        signaux fréq U(s), Y(s) & signaux fréq U(z), Y(z)\\ \hline
        transformée en s&  transformée en z\\ \hline
        équations différentielles&  équation aux différences\\ \hline
        fonction de transfert :&fonction de transfert :\\ 
        $G(s) = Y(s) / U(s)$& $G(z) = Y(z) / U(z)$\\ \hline
        gain statique : G(s=0) &gain statique : G(z=1)\\ \hline
        pôles, zéros, & pôles, zéros, \\ \hline
        diagr. de Bode&diagr. de Bode\\ \hline
        stabilité : $Re(s_k)$ < 0&stabilité : $|z_k| < 1$\\ 
        (demi-plan gauche)&(int. du cercle unit.)\\ \hline
    \end{tabular}
\end{center}
}
\hformbar

\formdesc{Régulateur Numérique}

\formtitle{Loi de commande }

\underline{régulateur PD numérique}
\vspace{3mm}

$u[k] = u[k] + b_0 \cdot e[k]+ b_1 \cdot e[k-1]$ 

avec :


\hfill $b_0 = Kp\cdot(1+\cfrac{T_d}{T_e})$\hfill et \hfill $b_1 = -Kp \cdot \cfrac{T_d}{T_e}$ \hfill

\vspace{3mm}

\underline{régulateur PI numérique}
\vspace{3mm}

$u[k] = u[k] + b_0 \cdot e[k]+ b_1 \cdot e[k-1]$ 

\hformbar


\formdesc{Échantillonnage}

temps d'échantillonnage, sampling h ou $T_s$ 

\includegraphics[width = 0.45\textwidth]{img/echantillonage.JPG}
\begin{center}
    avec $y[k] = y(k \cdot h)$
\end{center}



\formdesc{Inventaire des retards}

L‘étude « quasi temps-continu » est une première approche pour 
l’analyse et la synthèse approximative d’un système de régulation 
numérique.
Elle est basée sur l’inventaire des retards incontournables que 
possède une boucle de régulation numérique.

Retard du temps de calcul : $T_{cal} < \cfrac{h}{2}$

Retard du bloqueur d'ordre 0 : $T_{rec} \approx \cfrac{h}{2}$

\vspace{3mm}

Retard des conversions :

$T_{convAD} \approx T_{convAD} \approx \cfrac{h}{100} ... \cfrac{h}{10} $


\vspace{2mm}


\vspace{0.5cm}
\input{Tikz/inventaire_retard.tex}

\vspace{3mm}

Ce qui est approximable avec un retard pur par : 

\vspace{3mm}

\underline{Approximations du retard}

\begin{enumerate}
    \item Retard analogique (régime harmonique) :
    
        $e^{-j \omega T_r} = e^{j\varphi}$ avec $\varphi = - \omega T_r$

        $|e^{-j\omega T_r}| = 1$

        $arg(e^{-j\omega T_r}) = -T_r \cdot \omega$

    \item diagramme de Bode du retard analogique exact : 
        \begin{enumerate}
            \item système d'ordre 1 : 
            
                $e^{-j\omega T_r}  \approx \cfrac{1}{1+T_r\cdot j\omega}$

            \item Padé : 
                
                $e^{-j\omega T_r}  \approx \cfrac{1-\cfrac{T_r}{2}j\omega}{1+\cfrac{T_r}{2}j\omega}$

            Exact pour le module (1), mais pas pour la phase !

        \end{enumerate}
\end{enumerate}
\hformbar

\newpage

\formdesc{Rappel Nyquist}

\begin{enumerate}
    \item Condition de stabilité en boucle fermée basée sur un critère en boucle ouverte !
    \item Outil important pour l‘analyse des systèmes réglés, marge de gain $A_m$ , marge de phase $\varphi_m$.
    \item Outil important pour la synthèse des systèmes réglés, choix de $K_p$ pour obtenir $\varphi_m$ souhaitée.
\end{enumerate}

$\varphi_m = arg(G_o(j\omega_{co}))- (-\pi)$ \quad [rad]

\vspace{3mm}

$A_{m,dB} = -|G_o(j\omega_{\pi})| $\quad  [dB]

\vspace{3mm}

\formtitle{Liens entre la boucle ouverte et la boucle fermée} 

bande passante à -3 dB en boucle fermée $\omega_{bp} \approx$ pulsation de coupure en boucle ouverte $\omega_{co}$

$\omega_{bande,passante} = \omega_{co}$

Pulsation de coupure en b.o. $\omega_{co} \Leftrightarrow $ rapidité en b.f

\hformbar

\formdesc{Compensation du pôle dominant}

\begin{enumerate}
    \item Améliorer la dynamique, c-à-d rendre la boucle fermée plus rapide
    \item Faciliter les calculs
\end{enumerate}

\formtitle{Zéros libres du régulateur PI, PD, PID} 


\vspace{2mm}

\underline{PI :}

\vspace{2mm}

{\noindent$G_c(s) = K_p \cfrac{1+T_i \cdot s}{T_i \cdot s} \rightarrow$}

\begin{wrapfigure}[2]{r}{0.25\textwidth}
    \begin{center}
        \vspace{-3.7cm}
        \begin{tikzpicture}[]
            \tikzmath{
            coordinate \x;
            \x1 = (-1.5,0);
            }
            \draw[->] (-2,0) -- (1,0) node [anchor=west] {$R$};
            \draw[->] (0,-0.5) -- (0,0.5) node [anchor=south] {$Img$};
            \draw[thick] (\x1) circle (4pt) node[above=0.2cm] {$Z = -\cfrac{1}{T_i}$};
        \end{tikzpicture}
    \end{center}
  \end{wrapfigure}

  \vspace{10mm}

\underline{PD :}

\vspace{2mm}

{\noindent$G_c(s) = K_p (1+T_d \cdot s) \rightarrow$}

\begin{wrapfigure}[2]{r}{0.25\textwidth}
    \begin{center}
        \vspace{-3.5cm}
        \begin{tikzpicture}[]
            \tikzmath{
            coordinate \x;
            \x1 = (-1.5,0);
            }
            \draw[->] (-2,0) -- (1,0) node [anchor=west] {$R$};
            \draw[->] (0,-0.5) -- (0,0.5) node [anchor=south] {$Img$};
            \draw[thick] (\x1) circle (4pt) node[above=0.2cm] {$Z = -\cfrac{1}{T_d}$};
        \end{tikzpicture}
    \end{center}
  \end{wrapfigure}

  \vspace{10mm}


\underline{PID :}

\vspace{2mm}

{\noindent$G_c(s) = K_p \cfrac{1+T_i \cdot s+T_i \cdot T_d \cdot s^2}{T_i \cdot s}$}

\vspace{2mm}

zéros réels si : $T_i > 4\cdot T_d$

    \begin{center}
        \tikzset{cross/.style={cross out, draw=black, minimum size=2*(#1-\pgflinewidth), inner sep=0pt, outer sep=0pt},
        cross/.default={4pt}}
        \begin{tikzpicture}[]
            \tikzmath{
            coordinate \x;
            \x1 = (-5,0);
            \x2 = (-2,0);
            \x3 = (0,0);
            }
            \draw[->] (-6,0) -- (1,0) node [anchor=west] {$R$};
            \draw[->] (0,-0.5) -- (0,0.5) node [anchor=south] {$Img$};
            \draw[thick] (\x3) node[cross] {};
            \draw[thick] (\x2) circle (4pt) node[above=0.2cm] {$Z_1 \approx -\cfrac{1}{T_i}$};
            \draw[thick] (\x1) circle (4pt) node[above=0.2cm] {$Z_2 \approx -\cfrac{1}{T_d}$};
        \end{tikzpicture}
    \end{center}

    La compensation se fait en appliquant la règle suivante : 
    
    Zéro du régulateur = Pôle de système à régler

    \input{Tikz/pole_dominant.tex}

\hformbar

\newpage

\formdesc{schéma et FTZ dérivateur}


\begin{center}
    \begin{tikzpicture}[scale=0.5]
            \bXInput{E}
            \bXBloc[4]{sys}{$\cfrac{d}{dt}$}{E}
            \bXLink[$u(t)$]{E}{sys}
            \bXOutput[4]{S}{sys}
            \bXLink[$y(t)$]{sys}{S}
    \end{tikzpicture}
\end{center}

\vspace{-3mm}

\formtitle{Méthode des séquentes : }  

\vspace{3mm}

{\hfill $y[k] = \cfrac{du}{dt} \approx \cfrac{\Delta u}{\Delta t}= \cfrac{u[k]-u[k-1]}{h}$ \hfill}

\vspace{3mm}

\formtitle{schéma bloc numérique :}   

\begin{center}
    \begin{tikzpicture}
        \begin{small} 
            \bXInput{E}
            \bXBloc[4]{retard}{$Z^{-1}$}{E}
            \bXLink[$\text{u[k]}$]{E}{retard}
            \bXCompSum[6]{comp}{retard}{}{+}{-}{}
            \bXLink[$\text{u[k-1]}$]{retard}{comp}
            \bXBloc[4]{div}{$\cfrac{1}{h}$}{comp}
            \bXLink[]{comp}{div}
            \bXOutput[4]{S}{div}
            \bXLink[$\text{y[k]}$]{div}{S}
            \bXReturn{E-retard}{comp}{}
            \node at (E-retard)[circle,fill,inner sep=1pt,below=0.225cm]{};
        \end{small}
    \end{tikzpicture}
    $G_d(Z) = (1-z^{-1}) \cdot \cfrac{1}{h} = \cfrac{Z-1}{hZ}$
\end{center}

\hformbar

\formdesc{schéma et FTZ intégrateur}

\begin{center}
    \begin{tikzpicture}
            \bXInput{E}
            \bXBloc[4]{sys}{\huge$\int$}{E}
            \bXLink[$u(t)$]{E}{sys}
            \bXOutput[4]{S}{sys}
            \bXLink[$y(t)$]{sys}{S}
    \end{tikzpicture}
\end{center}

\vspace{-3mm}

\formtitle{Méthode des rectangles : }   

\vspace{3mm}

{\hfill $y[k+1] = y[k] + h \cdot u[k]$\hfill} 

\vspace{3mm}

\underline{schéma bloc numérique :}   

\begin{center}
    \begin{tikzpicture}
        \begin{small} 
            \bXInput{E}
            \bXBloc[4]{h}{$h$}{E}
            \bXSumb[6]{comp}{h}
            \bXBloc[4]{ret}{$Z^{-1}$}{comp}
            \bXOutput[4]{S}{ret}
            \bXLink[$\text{u[k]}$]{E}{h}
            \bXLink[]{h}{comp}
            \bXLink[$\text{y[k+1]}$]{comp}{ret}
            \bXLink[$\text{y[k]}$]{ret}{S}
            \bXReturn{ret-S}{comp}{}
            \node at (ret-S)[circle,fill,inner sep=1pt,below=0.225cm]{};
        \end{small}
    \end{tikzpicture}
    $G_i(Z) = \cfrac{h \cdot z^{-1}}{1 - z^{-1}}= \cfrac{h}{Z-1}$
\end{center}

\hformbar

\formdesc{Méthode de "Tustin" (trapèzes) : }   

\underline{Idée de la méthode de numérisation de "Tustin" :}

pour une fonction de transfert analogique quelconque, 
remplacer chaque occurrence de s par l'expression en z ci-dessous

\vspace{3mm}

$y[k] = y[k-1] + h \cdot \cfrac{u[k-1]+u[k]}{2}$

\vspace{3mm}

$G_i(Z) = \cfrac{h \cdot (z^{-1}+1)}{2(1 - z^{-1})} \approx \cfrac{1}{S}$


$G_d(Z) = \cfrac{2(1 - z^{-1})}{h \cdot (z^{-1}+1)} \approx S$

\hformbar

\newpage

\formdesc{Lieu des poles(Root locus)}

\footnotesize Outil important permettant la synthèse de systèmes réglés : 
\begin{enumerate}
 \item choix de Kp
\end{enumerate}

pôles complexes conjugués :

{\hfill $s_{1,2} = -\delta \pm j\omega $\hfill}

Réponse indicielle :

{\hfill $g(t) = e^{-\delta \cdot t} \cdot sin(\omega t) $\hfill}

Rappel (formulaire régulation automatique) : 

{\hfill $T_{reg} = \cfrac{3}{\delta} = \cfrac{-3}{\mathbb{R}(s_f)}$\hfill}\vspace{3mm}

Règles de tracer du lieu des pôles (L.d.P) :
\begin{enumerate}
    \item L.d.P a n branches = degré du dénominateur 
    \item L.d.P a M branches = degré du numérateur
    \item L.d.P symétrique par l'axe $\mathbb{R}$
    \item Points de départ à $K_p = 0$
    \item Points de fin à $K_p = \infty$
    \item $d = n-m$ branches restante partent en asymptote infinie, où d correspond au degré relatif de la B.O\\ les asymptotes forment des étoiles régulières
    \item Tout point de l'axe réel situé à gauche d'un nombre impair de pôles et de zéros réels fait partie du lieu
\end{enumerate}

\input{Tikz/loi_des_poles.tex}

\hformbar



%\includepdf[pages=-]{img/cheat.pdf}

\end{document}